---
import Layout from '@/layouts/Layout.astro';
import { TankPlannerPage } from '@/components/TankPlanner/TankPlannerPage';
import type { TankItem, PlantItem } from '@/components/TankPlanner/types';
import { getAllFish, getAllTanks, getAllPlants, convertTanksForPlannerPage } from '@/services/collections';

// Fetch data using our centralized collections service
const [allFish, allTanks] = await Promise.all([
  getAllFish(),
  getAllTanks()
]);

// Fetch plants separately to help with debugging
console.log('Fetching plants...');
const allPlants = await getAllPlants();
console.log('Fetched plants:', allPlants);

// Convert tanks to the format expected by TankPlannerPage
const formattedTanks = convertTanksForPlannerPage(allTanks);

// Log all data being passed to TankPlannerPage
console.log('Data being passed to TankPlannerPage:', {
  fishCount: allFish.length,
  plantsCount: allPlants.length,
  tanksCount: formattedTanks.length
});
---

<Layout title="Tank Planner">
  <div class="min-h-screen bg-blue-50 dark:bg-gray-900">
    <TankPlannerPage 
      client:only="react" 
      allFish={allFish} 
      allPlants={allPlants} 
      allTanks={formattedTanks} 
    />
  </div>
</Layout>
